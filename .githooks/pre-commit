#!/bin/sh
# Git hook pre-commit pour vÃ©rifier le format Markdown

echo "ğŸ” VÃ©rification du format Markdown..."

# VÃ©rifier s'il y a des fichiers markdown modifiÃ©s
MARKDOWN_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.md$')

if [ -z "$MARKDOWN_FILES" ]; then
    echo "âœ… Aucun fichier Markdown modifiÃ©"
    exit 0
fi

# VÃ©rifier les erreurs MD036 (emphase utilisÃ©e comme titre)
MD036_ERRORS=0
for file in $MARKDOWN_FILES; do
    if [ -f "$file" ]; then
        # Rechercher les patterns d'emphase utilisÃ©e comme titre
        if grep -qE '^\*\*.*[!âœ¨ğŸ‰âœ…].*\*\*$' "$file" || \
           grep -qE '^\*\*[A-Z][A-Z\s]*[A-Z]\*\*$' "$file" || \
           grep -qE '^\*\*(âœ…|ğŸ‰|âœ¨|ğŸ‡¬ğŸ‡¦|ğŸ¯|ğŸ†|ğŸ”§)\s+.*\*\*$' "$file"; then
            echo "âŒ Erreur MD036 dans $file : Emphase utilisÃ©e comme titre"
            echo "   Utilisez ## ou ### au lieu de **texte**"
            MD036_ERRORS=$((MD036_ERRORS + 1))
        fi
    fi
done

if [ $MD036_ERRORS -gt 0 ]; then
    echo ""
    echo "ğŸ’¡ Pour corriger automatiquement ces erreurs :"
    echo "   node scripts/fix-markdown-emphasis.js"
    echo ""
    echo "âŒ Commit rejetÃ© Ã  cause d'erreurs de format Markdown"
    exit 1
fi

echo "âœ… Format Markdown correct"
exit 0
